<script>
var r = 8;
var x = 0;
var y = 0;
var g = 2;
var t;
var last;
var c;
var ctx;
var cs = [];

window.onload = function () {
	c = document.querySelector(".circle");
	v = document.getElementById("canvas");
	ctx = v.getContext("2d");
	
	c.style.width = 2 * r + "px";
	c.style.height = 2 * r + "px";
	c.style.borderRadius = r + "px";

	setInterval(_ => {

	});
	
	v.addEventListener('mousemove', (event) => {
		x = (event.clientX >> g) << g;
		y = (event.clientY >> g) << g;
		// c.style.top = y - r + "px";
		// c.style.left = x - r + "px";
		ctx.clearRect(0, 0, v.width, v.height);
		ctx.fillStyle = "#f00";
		for (var i = 0; i < cs.length; ++i) {
			ctx.beginPath();
			ctx.arc(cs[i].x, cs[i].y, cs[i].r, 0, Math.PI * 2);
			ctx.closePath();
			ctx.fill();
		}

		ctx.beginPath();
		ctx.arc(x, y, r, 0, Math.PI * 2);
		ctx.closePath();
		ctx.fill();
	});
	
	addEventListener('click', (event) => {
		clearTimeout(t);
		t = setTimeout(_ => {
			// last = c.cloneNode(true);
			// document.body.appendChild(last);
			// console.log(x, y, r);
			var name = prompt("name");
			cs.push({name: name, x: x, y: y, r: r});
		}, 10);
	});

	addEventListener('keyup', (event) => {
		console.log(event);
		if (event.keyCode === 107) {// === '+') {
			r += 2;
			c.top -= 2;
			c.left -= 2;
		} else if (event.keyCode === 109) {// === '-') {
			r -= 2;
			c.top -= 2;
			c.left -= 2;
		} else if (event.keyCode === 81) {// === "q") {
			g += 1;
			console.log(g);
		} else if (event.keyCode === 87) {// === "w") {
			g -= 1;
			console.log(g);
		} else if (event.keyCode === 68) {// === 'd') {
			cs.pop();
		} else if (event.keyCode === 32) {// === " ") {
			console.log(cs);
		}
		c.style.width = r * 2 + "px";
		c.style.height = r * 2 + "px";
		c.style.borderRadius = r + "px";
	});
}
</script>

<style>
	body {
		margin: 0;
	}
	.circle {
		position: absolute;
		background-color: #f00;
		width: 10;
		height: 10;
	}
	.inner {
		position: relative;
		width: 1;
		height: 1;
		background-color: #00f;
	}
	#canvas {
		background: url(img2.png);
	}
</style>

<div class="circle"><div class="inner"></div></div>
<canvas id="canvas" width="600" height="480"></canvas>
